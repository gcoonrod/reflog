# Quickstart: Reflog MVP Core

**Branch**: `001-mvp-core` | **Date**: 2026-02-19 | **Updated**: 2026-02-19

## Prerequisites

- Node.js 20+ (LTS)
- pnpm (preferred) or npm

## Setup

```bash
# Clone and switch to feature branch
git clone <repo-url>
cd reflog
git checkout 001-mvp-core

# Install dependencies
pnpm install

# Start development server
pnpm dev
```

The app will be available at `http://localhost:3000`.

## Key Commands

| Command | Description |
|---------|-------------|
| `pnpm dev` | Start TanStack Start dev server |
| `pnpm build` | Production build (static SPA) |
| `pnpm preview` | Preview production build locally |
| `pnpm test` | Run Vitest unit/integration tests |
| `pnpm test:e2e` | Run Playwright E2E tests |
| `pnpm lint` | Run ESLint |
| `pnpm format` | Run Prettier |
| `pnpm typecheck` | Run TypeScript type checking |

## Project Structure

```text
src/
├── components/          # React components
│   ├── editor/          # CodeMirror editor + Markdown preview
│   ├── timeline/        # Entry list (reverse chronological)
│   ├── search/          # Search palette (Spotlight)
│   ├── vault/           # Unlock screen, setup wizard
│   ├── tags/            # Tag badges, filter UI
│   └── common/          # Error boundaries, layout
├── db/                  # Dexie database schema + encryption hooks
├── hooks/               # Custom React hooks
│   ├── useVault.ts      # Vault unlock/lock state
│   ├── useEntries.ts    # Entry CRUD operations
│   ├── useSearch.ts     # Search index + query
│   ├── useTags.ts       # Tag extraction + filtering
│   ├── useAutoLock.ts   # Inactivity + visibility monitoring
│   └── useKeyboard.ts   # Global keyboard shortcuts
├── routes/              # TanStack Router file-based routes
│   ├── __root.tsx       # Root layout (AppShell, shortcuts, error boundary)
│   ├── index.tsx        # Redirect to /unlock or /timeline
│   ├── setup.tsx        # First-time passphrase creation
│   ├── unlock.tsx       # Passphrase entry
│   ├── timeline.tsx     # Entry list with tag filtering
│   └── entry/
│       ├── new.tsx      # New entry editor
│       ├── $id.tsx      # View single entry
│       └── $id.edit.tsx # Edit existing entry
├── services/            # Business logic
│   ├── crypto.ts        # Web Crypto API utilities
│   ├── vault.ts         # Vault service implementation
│   ├── entries.ts       # Entry CRUD with encryption
│   ├── search.ts        # MiniSearch wrapper
│   ├── tags.ts          # Tag parsing + normalization
│   ├── autoLock.ts      # Auto-lock timer + visibility
│   └── keyboard.ts      # Shortcut registration
├── theme/               # Mantine theme configuration
│   └── index.ts         # Dark theme, monospace fonts
├── types/               # TypeScript interfaces
│   └── index.ts         # Entry, Tag, VaultMeta, etc.
└── utils/               # Shared helpers
    └── date.ts          # Date/time formatting

public/
├── manifest.webmanifest  # PWA manifest (auto-generated by vite-plugin-pwa)
└── icons/               # App icons (multiple sizes)

tests/
├── unit/                # Vitest: crypto, tags, search
├── integration/         # Vitest: Dexie operations with encryption
└── e2e/                 # Playwright: full user journeys
```

## First Run Verification

1. Open `http://localhost:3000`
2. You should see the passphrase setup screen
3. Create a passphrase (minimum 8 characters)
4. Confirm the warning about irrecoverable data
5. You should see an empty timeline with a "New Entry" action
6. Press `Cmd/Ctrl + N` to create your first entry
7. Type some Markdown, toggle to preview to verify rendering
8. Press `Cmd/Ctrl + Enter` to save
9. The entry should appear in the timeline

## PWA Testing

```bash
# Build for production
pnpm build

# Preview with service worker active
pnpm preview
```

Then in Chrome DevTools:
1. Application → Service Workers → verify registered
2. Application → Manifest → verify installable
3. Network → toggle Offline → verify app still works
4. Run Lighthouse → verify PWA criteria pass

## Testing

```bash
# Unit + integration tests
pnpm test

# E2E tests (requires build first)
pnpm build && pnpm test:e2e

# Type checking
pnpm typecheck

# Full quality gate (matches constitution commit requirements)
pnpm typecheck && pnpm lint && pnpm test && pnpm build
```
